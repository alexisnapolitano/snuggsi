const
  { test, fetch }
    = require ('test')

, { Server }
    = require ('..')


test ('calling next middleware')


test ("Content-Security-Policy: report-uri 'self';")


test ("Content-Security-Policy: default-src 'none';", async t => {

  const
    server   = (new Server).serve ``
  , response = await fetch ('http://localhost:8181/')


  t.ok (response.headers.get ('content-security-policy'))

  server.close ``
  t.end ()
})


test ("Content-Security-Policy: frame-src 'self';")
test ("Content-Security-Policy: connect-src 'self';")
test ("Content-Security-Policy: img-src 'self' https://cdn.example.com;")


test.only ("Content-Security-Policy: style-src 'none';", async t => {

  const
    server   = (new Server).serve ``
  , response = await fetch ('http://localhost:8181/')


  console.log (response.headers)

  t.ok
    (response.headers.get ('content-security-policy').includes `style-src 'none'`)

  server.close ``
  t.end ()
})


test ("Content-Security-Policy: script-src 'self';")
