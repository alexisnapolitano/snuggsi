const
  { test } = require ('.')

, sleep = time => new Promise
    (alarm => setTimeout (alarm, time))

, zip = ( tokens, result = '' ) =>
    [
      (result, fragment) =>
        result += `${ fragment }${ tokens.shift `` || `` }`
    , result
    ]


function test2 (fragments, ...tokens) {
  let
    name =
      [ ]
      //.flat   ( ) // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/flat
        .concat ( fragments )
        .reduce ( ... zip (tokens) )

  return callback =>
    test (name, Case (callback))
}

function Case (definition) {
  let funk = async function (t) {


    console.warn ('Case definition', definition)
    console.warn ('t', t.assert)
    console.warn ('test', test)

    await definition (t.assert)

    t.end ()
  }



  return funk // definition
}

//test2 ('legacy test')
//( true === true )

//test2 `.test`
//  (t => { t.skip `when loading tape causes tests to run`, t.end () })

//test2 `.Server`
//  (t => { t.assert ('Server' in require ('.')), t.end () })

//test2 `.Resource`
//  (t => { t.assert ('Resource' in require ('.')), t.end () })


test2 `snuggsi.test HOT DAMN!`
  ( assert => assert (true) )
